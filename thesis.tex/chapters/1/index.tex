\chapter{Introduction}

With new companies jumping into the Internet of Things (IoT), 
major \emph{IT actors} investing in the development of new
products\footnote{\url{https://www.fortunebusinessinsights.com/industry-reports/internet-of-things-iot-market-100307}},
 telecoms building infrastructure for this new 
demand\footnote{\url{https://www.proximus.be/en/id_cl_iot/companies-and-public-sector/it-services/iot/internet-of-things.html}}.
IoT technology allows the gathering of data and the control of actuaturs via
the Internet without any human interaction.
The field has been developed during the last decade and has mainteined a
consistent growth since.
Business analysts agree that we can expect to reach at least 40 billion
installed \emph{IoT} devices by
2027\footnote{\url{https://www.businessinsider.com/internet-of-things-report}}. 
Costumers are already familiar with the traditional \emph{IoT} products
we use in our households. Those products allow to connect our light bulbs, fridge and
washing machine to the Internet.
Meanwhile we have less knowledge on the industrial usage of \emph{IoT}, also
known as industrial IoT (IIoT). \emph{IIoT} is one of the fastest growing
segment of the market.
More and more industries are adopting IIoT to consolidate their productions
with \emph{real-time monitoring}, to organize predictive maintenance on their
assets and products to connect their supply chains, etc \ldots
All of this is enabled with
the help of network of sensors, and actuators, in a wide variety of
sectors like \emph{smart farming}, \emph{smart cars}, \emph{smart cities},
\emph{energy managements}, \ldots

\paragraph{}

All these applications have in common that they count on devices that
communicate wirelessly.
% TODO Change not telecom
Telecoms created new technologies to suit this new domain that can be
classified by three different characteristics being.

\begin{itemize}
    \item Long or Short \emph{range}
    \item High or low \emph{data-rate}
    \item Low or high \emph{power usage} 
\end{itemize}

% From these characteristics you can only chose two according to the physical
% law. % TODO Explanation needed with the exact law reference explaining this
Figure~\ref{fig:commrangegraph} show the classification
of the existing wireless communication protocol used in the \emph{IoT} and
present it in three main categories.

\begin{itemize}
    \item \emph{Short-Range wireless} communication Short range, high data-rate
    \item \emph{Cellular} communication Long range, high data-rate
    \item \emph{Low-power wide-area network (LPWAN)} communication Long range, low power and low data-rate
\end{itemize}

\input{thesis.tex/chapters/1/fig/comparaison.tex}

This work focuses only on \emph{LoRa}, a proprietary \emph{chirp spread spectrum}
modulation technique owned by \emph{Semtech}, operating in the sub-GHz
unlicensed \emph{ISM} band, that will be explained in more details in 
Section~\ref{section:lora}.
The main characteristics of \emph{LoRa} are its low power transmission and the
fact that it can trade throughput for range.
The long-range capabilities of the protocol haves caught the attention of
many people. 
Some have succeeded to obtain record distance transmission of over 700 km with
direct line of sight between the receiver and the
transmitter\footnote{https://www.thethingsnetwork.org/article/ground-breaking-world-record-lorawan-packet-received-at-702-km-436-miles-distance}.
However, this case is not a real world example. The range in urban areas is of
around \emph{2 to 5 km} and around \emph{15 km} in suburban
areas~\cite{8030482}.
Fine-tuning the \emph{PHY} settings of the protocol
allows to trade communication distance for throughput.
% and a longer band usage,
% which decreases the number of concurrent motes that can communicate over the
% band~\cite{10.1145/2988287.2989163}.

\emph{LoRa} is often used in conjunction with the \emph{LoRaWAN} a 
LPWAN protocol.
% point-to-multipoint.
\emph{LoRaWAN} is an ALOHA based~\cite{loraalliance:lorawanspecification}
MAC protocol for organizing a network
using a star-of-stars topology composed of wirelessly interconnected 
\emph{motes} sending data to \emph{gateways} (GWs). 
Those GWs will relay messages to central servers over Cellular or Ethernet
connections as we can see in Figure~\ref{fig:startopology}.
This single-hop topology is an easy to deploy solution because free and paid
LoRaWAN network are already in use
\footnote{\url{https://www.thethingsnetwork.org/map}}.

\input{thesis.tex/chapters/1/fig/topology.tex}

The issue with \emph{LoRaWAN} as studied 
in~\cite{8030482}~\cite{10.1145/2988287.2989163} is, that it does not scale. 
% This occurs especially 
% with dense networks, like in urban environments, where collisions can
% happen on transmission.

LoRaWAN is an \emph{ALOHA} based MAC protocol and channel sensing is impossible 
because \emph{Channel Activity Detection} (CAD) only detect the preamble of a 
communication. % TODO reference needed
This leads to collision when motes transmitting at the same time and
the transmission has to be re-done using a back-off strategy till the message
has been correctly received or the number of trials has reached its maximum.
Those collisions lead to more energy consumption for the motes and more radio 
channel usage.
As the network gets more dense~\cite{8030482}, the effect of collisions gets
increasingly significant with little to no packets getting received by gateways.

The \emph{duty-cycle} regulations in place for the \emph{ISM} bands on every
transmitting device (motes and gateways) is also a limiting factor 
for \emph{LoRaWAN} (\cite{8030482}).
The European ISM band has set a duty-cycle of \emph{1\%} meaning that each node 
and gateway can transmit \emph{36 sec/hour} maximum. 
% Increasing the retransmission is impossible.
Increasing the number of retransmissions of a packet quickly becomes
unpractical.
% TODO {Add some reference to ISM regulations} 

Link quality also influences LoRaWAN's efficiency. 
Motes on the limit of the gateway coverage area may struggle to
complete transmissions. 
In addition, environmental factor like temperature, humidity as studied 
in~\cite{evaluation_of_the_reliability_of_lora}, the topology of the 
terrain~\cite{lorajambalaya}, influence the link quality.
All these factor make the networks coverage typically not uniform 
as can seen in Fig~\ref{fig:coverage}.

Gateways can restrain the deployment of LoRa networks.
They may not be deployed everywhere as they require more demanding infrastructure 
than battery operated motes.
% TODO Weird next phrase statement about gateways.
That is the case for pipelines and tunnel as in~\cite{Abrardo_2019},
we would prefer to only install motes running on batteries because
gateways would not have much effect with the linear nature of the installation.
They can also be a single point of failure of the network, when a single
gateway is connecting a portion of the network. 
The network disconnects on technical issues.

\input{thesis.tex/chapters/1/fig/coverage.tex}

% \begin{tikzpicture}
%     \node[draw] (Application) [abstract, rectangle]{\textbf{Application Layer}};
%     \node[draw] (MAC) [abstract, rectangle, below=0.2cm of Application, text justified]{\textbf{Media Access Control (MAC) Layer}};
%     \node[draw] (Phy) [abstract, rectangle, below=0.2cm of MAC, text justified]{\textbf{Physical (PHY) Layer}};
%     \node[draw] (Rf) [abstract, rectangle, below=0.2cm of Phy, text justified]{\textbf{Radio Frequency (RF) Layer}};
% \end{tikzpicture}

\paragraph{}

Multi-hop routing protocols (Fig~\ref{fig:meshtopology}) can mitigate
the LoRaWAN congestion issues (\cite{8115756}).
% TODO talk about multi-hop lorawan
Increasing the redundancy and the reliability of the lossy network could be a
solution to the previously exposed problems.
A multi-hop network can adapt to this kind of variation, routing protocols can
keep track and change packets routes for not responding nodes
% TODO {Maybe cite study with the node in water roover}
Also multi-hop is a strong candidate for large areas monitoring application
where few gateways may be available or where blind spots arise.
% TODO more than one work !!
Work to create multi-hop routing protocol with LoRa has already been
done in~\cite{8115756} but did not take into account the energy consumption of
the motes.
The \emph{IEEE 802.15.4} standard already developed, a Medium Access Control (MAC)
protocol, named \emph{TSCH} to solve the energy consumption problem and
increase the realiability.

Work to adapt TSCH for LoRa in~\cite{8847137} and~\cite{njomgang_2018}, has
already been done at \emph{VUB}.
This thesis builds on the combined efforts of the previous
years to adapt \emph{TSCH} for the \emph{Zolertia RE-Mote} working with the
\emph{RN2483} LoRa shield.

\chapter{Introduction}

With each year new companies jumping into the \emph{IoT} sector and all the
major \emph{IT actors} investing in the development of new
products\footnote{\url{https://www.fortunebusinessinsights.com/industry-reports/internet-of-things-iot-market-100307}},
as well as telecoms building infrastructure for this new 
demand\footnote{\url{https://www.proximus.be/en/id_cl_iot/companies-and-public-sector/it-services/iot/internet-of-things.html}}
The \emph{Internet of Things}, describing interconnected devices gathering
data without human interaction, has undoubtedly been a subject of hype during the
last decade while maintaining a consistent growth until now.
Business analysts agree that we should expect to reach at least 40 billion
installed \emph{IoT} devices by
2027\footnote{\url{https://www.businessinsider.com/internet-of-things-report}}. 
Consumers are already familiar with the traditional \emph{IoT} products
we use in our households. They allow to connect our light bulbs, our fridge and
washing machine, \ldots
Meanwhile we have less knowledge of the industrial usage of \emph{IoT}, also
known as \emph{IIoT}. \emph{IIoT} is one of the fastest growing domain of the
market. More and more industries are adopting \emph{IoT}  to consolidate their
productions with \emph{real-time monitoring}, predictive maintenance on their
assets and products, connecting their supply chains, all of this enabled with
the help of network of sensors, in a wide variety of
sectors like \emph{smart farming}, \emph{smart cars}, \emph{smart cities},
\emph{energy managements}, \ldots

\paragraph{}

All these applications have in common to communicate wirelessly.
Telecoms created new technologies to suit this new domain that can be
characterized by three different characteristics.

\begin{itemize}
    \item Long or Short \emph{range}
    \item High or low \emph{data-rate}
    \item Low or high \emph{power usage} 
\end{itemize}

% From these characteristics you can only chose two according to the physical
% law. % TODO Explanation needed with the exact law reference explaining this
The following graphics (Fig~\ref{fig:commrangegraph}) show the classification
of the existing wireless communication protocol used in the \emph{IoT} and mix
it in three main categories.

\begin{itemize}
    \item \emph{Short-Range wireless communication} Short range, high data-rate
    \item \emph{Cellular communication} Long range, high data-rate
    \item \emph{LPWAN communication} Long range, low power and low data-rate
\end{itemize}

\input{thesis.tex/chapters/1/fig/comparaison.tex}

This work focus only on \emph{LoRa}, a proprietary \emph{chirp spread spectrum}
modulation technique owned by \emph{Semtech}, operating in the sub-GHz
unlicensed \emph{ISM} band, that will be explained in more details in 
Section~\ref{section:lora}.
The main characteristics of \emph{LoRa} is that it trade throughput for range
and low power transmission. 
The long-range capabilities of the protocol has caught the attention of
many people with record distance transmission over 700 km
with direct line of sight between the receiver and the
transmitter\footnote{https://www.thethingsnetwork.org/article/ground-breaking-world-record-lorawan-packet-received-at-702-km-436-miles-distance}.
However, this case is not a real world example, we should still expect a typical 
range in urban areas of around \emph{2 to 5 km} and \emph{15 km} in suburban
areas~\cite{8030482}. Fine-tuning the \emph{PHY} settings of the protocol also
allow trading communication distance over throughput and a longer band usage,
which decrease the number of concurrent motes that can communicate over the
band~\cite{10.1145/2988287.2989163}.

\emph{LoRa} is often used in conjunction with the \emph{LoRaWAN} a 
point-to-multipoint protocols.
\emph{LoRaWAN} is a ALOHA based~\cite{loraalliance:lorawanspecification} network
using a star-of-stars topology composed of wirelessly interconnected 
\emph{motes} sending data to \emph{gateways}, relaying messages to central 
servers over Cellular or Ethernet connections as we can see in 
Figure~\ref{fig:startopology}.
This single-hop topology is an easy to deploy solution because network coverage
for LoRaWAN is fairly
developed\footnote{\url{https://www.thethingsnetwork.org/map}}.

\input{thesis.tex/chapters/1/fig/topology.tex}

The issue with \emph{LoRaWAN} as studied 
in~\cite{8030482}~\cite{10.1145/2988287.2989163} is, it does not scale. 
% This occurs especially 
% with dense networks, like in urban environments, where collisions can
% happen on transmission.

LoRaWAN is a \emph{ALOHA} based MAC protocol and channel sensing is impossible 
because \emph{Channel Activity Detection} (CAD) only detect the preamble of a 
communication. % TODO reference needed
This lead to collision when transmitting at the same time and until the message 
is correctly sent, the transmission has to be re-done.
This lead to more energy consumption for the motes and more radio 
channel usage.
As the network get more dense~\cite{8030482}, the effect of collision get 
increasingly significant with little to no packet getting received by gateways.

The \emph{duty-cycle} regulations in place with the \emph{ISM} bands on every
transmitting devices (motes and gateways) is then a limiting factor 
for \emph{LoRaWAN} (\cite{8030482}).
The european ISM band has set a duty-cycle of \emph{1\%} meaning each node 
and gateway can transmit \emph{36 sec/hour} maximum. 
% Increasing the retransmission is impossible.
Increasing the number of retransmission of a packet quickly become impossible.
% TODO {Add some reference to ISM regulations} 

Link quality influence LoRaWAN efficiency. 
Motes on the limit of the gateway coverage may struggle to
complete transmission. 
Environmental factor like temperature, humidity as studied 
in~\cite{evaluation_of_the_reliability_of_lora}, the topology of the 
terrain~\cite{lorajambalaya}, influence the link quality.
All these factor make the network coverage typically not uniform 
as we can see in Fig~\ref{fig:coverage}.

Gateways can restrain the deployment of LoRa networks.
They may not be available to deploy everywhere and some use cases may not even allow
the installation of gateways because they require more demanding infrastructure 
than battery operated motes.
That's the case for pipelines and tunnel as in~\cite{Abrardo_2019},
we would prefer to only install motes running on batteries because
gateways wouldn't have much effect with the linear nature of the installation.
They can also be a single point of failure of the network, when a single
gateway is connecting a portion of the network. 
The network disconnects on technical issues.

\input{thesis.tex/chapters/1/fig/coverage.tex}

% \begin{tikzpicture}
%     \node[draw] (Application) [abstract, rectangle]{\textbf{Application Layer}};
%     \node[draw] (MAC) [abstract, rectangle, below=0.2cm of Application, text justified]{\textbf{Media Access Control (MAC) Layer}};
%     \node[draw] (Phy) [abstract, rectangle, below=0.2cm of MAC, text justified]{\textbf{Physical (PHY) Layer}};
%     \node[draw] (Rf) [abstract, rectangle, below=0.2cm of Phy, text justified]{\textbf{Radio Frequency (RF) Layer}};
% \end{tikzpicture}

\paragraph{}

Multi-hop routing protocol (Fig~\ref{fig:meshtopology}) can mitigate
the LoRaWAN congestion issues (\cite{8115756}).
Increasing the redundancy and the reliability of the lossy network could be a
solution to the previously exposed problems.
A multi-hop network can adapt to this kind of variation, routing protocols can
keep track and change packets routes for not responding nodes
% TODO {Maybe cite study with the node in water roover}
Also multi-hop is a strong candidate for large areas monitoring application
where few gateways may be available.

Work to create multi-hop routing protocol with LoRa has already been
done in~\cite{8115756} but didn't take into account the energy consumption of
the motes.
The \emph{IEEE 802.15.4} standard already developed, a Medium Access Control (MAC)
protocol, named \emph{TSCH} to solve the energy consumption problem.

Work to adapt TSCH for LoRa in~\cite{8847137} and~\cite{njomgang_2018}, has
already been done at \emph{VUB}.
This thesis is part of the outcome of the combined efforts of the previous
years to adapt \emph{TSCH} for the \emph{Zoleratia RE-Mote} working with the
\emph{RN2483} LoRa shield.
